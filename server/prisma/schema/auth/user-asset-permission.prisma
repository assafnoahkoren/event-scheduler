// User asset permissions model for fine-grained access control

model UserAssetPermission {
  id            String          @id @default(uuid())
  userId        String          @map("user_id")
  level         Level           @map("level")
  assetType     AssetType       @map("asset_type")
  assetId       String          @map("asset_id")
  config        Json            @default("{}")

  // Timestamps
  createdAt     DateTime        @default(now()) @map("created_at")
  updatedAt     DateTime        @updatedAt @map("updated_at")
  expiresAt     DateTime?       @map("expires_at")

  // Soft delete
  deletedAt     DateTime?       @map("deleted_at")
  deletedBy     String?         @map("deleted_by")
  isDeleted     Boolean         @default(false) @map("is_deleted")

  // Relations
  user          User            @relation(fields: [userId], references: [id], onDelete: Cascade)

  // Ensure unique permission per user-asset combination
  @@unique([userId, assetType, assetId, level])

  // Indexes for performance
  @@index([userId])
  @@index([assetType, assetId])
  @@index([expiresAt])
  @@index([isDeleted])

  @@map("user_asset_permissions")
}

// Permission level enum
enum Level {
  READ
  WRITE
  DELETE
  ADMIN

  @@map("level")
}

// Asset types enum
enum AssetType {
  USER
  SYSTEM

  @@map("asset_type")
}