// User model for local authentication

model User {
  id            String    @id @default(uuid())
  email         String    @unique
  username      String    @unique
  passwordHash  String    @map("password_hash")

  // Profile information
  firstName     String?   @map("first_name")
  lastName      String?   @map("last_name")
  avatarUrl     String?   @map("avatar_url")
  bio           String?

  // Account status
  isActive      Boolean   @default(true) @map("is_active")
  isEmailVerified Boolean @default(false) @map("is_email_verified")
  emailVerifiedAt DateTime? @map("email_verified_at")

  // Authentication tracking
  lastLoginAt   DateTime? @map("last_login_at")
  lastLoginIp   String?   @map("last_login_ip")
  loginCount    Int       @default(0) @map("login_count")
  passwordChangedAt DateTime? @map("password_changed_at")

  // Timestamps
  createdAt     DateTime  @default(now()) @map("created_at")
  updatedAt     DateTime  @updatedAt @map("updated_at")

  // Relations
  sessions      Session[]
  refreshTokens RefreshToken[]
  passwordResets PasswordReset[]
  assetPermissions UserAssetPermission[]

  // Site relations
  ownedSites    Site[]           @relation("OwnedSites")
  siteUsers     SiteUser[]
  sentInvitations    SiteInvitation[] @relation("SentInvitations")
  acceptedInvitations SiteInvitation[] @relation("AcceptedInvitations")
  events        Event[]
  clients       Client[]

  @@index([email])
  @@index([username])
  @@map("users")
}